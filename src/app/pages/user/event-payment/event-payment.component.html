<div class="audience-page audience-body">
  <!-- HEADER -->
  <header class="audience-header">
    <div class="container">
      <div class="header-row">
        <!-- Left Section (Logo + Breadcrumbs) -->
        <div class="header-col left-section-col">
          <div class="left-section-content">
            <!-- Logo -->
            <div class="logo-wrapper">
              <img
                class="logo"
                src="https://zentrotechnologies.com/wp-content/uploads/2025/02/Zentro_Final-Logo-05-scaled-e1753251642526.png"
                alt="Zentro Logo"
              />
            </div>

            <!-- Breadcrumbs -->
            <nav class="breadcrumbs">
              <span class="back-arrow" [routerLink]="['/events']">←</span>

              <span class="crumb" [routerLink]="['/events']">Events</span>
              <span class="separator">›</span>

              <span class="crumb" [routerLink]="['/event-booking', eventId, eventNameSlug]">{{ getFormattedEventTitle() }}</span>
              <span class="separator">›</span>

              <span class="crumb" [routerLink]="['/seats-booking', eventId, eventNameSlug]">Select Seats</span>
              <span class="separator">›</span>

              <span class="crumb active muted">Review & Pay</span>
            </nav>
          </div>
        </div>

        <!-- Right Column -->
        <div class="header-col actions-col">
          <div class="user-actions">
            <div class="location muted">Pune ▼</div>
            <!-- Show user name when logged in -->
            <div *ngIf="authService.isLoggedIn()" class="user-welcome">
              Welcome, {{ authService.getUserDisplayName() }}!
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>

  <!-- PAGE CONTENT -->
  <main class="payment-page">
    <div class="payment-container">
      <!-- LEFT SECTION -->
      <section class="payment-left">
        <div class="payment-card">
          <h3 class="card-title">Please select from the following option(s)</h3>

          <!-- M Ticket -->
          <label class="radio-row">
            <input type="radio" checked />
            <div class="radio-content">
              <div class="radio-title">M-Ticket</div>
              <div class="radio-sub">Save the planet. Use your phone as a ticket.</div>
            </div>
          </label>

          <!-- Info Box -->
          <div class="info-box">
            <h4>M-Ticket Information</h4>
            <ol>
              <li>
                Customer(s) can access their ticket(s) from the 'My Profile' section on the
                app/mobile-web.
              </li>
              <li>It is mandatory to present the ticket(s) via app/mobile-web at the venue.</li>
              <li>No physical ticket(s) are required.</li>
            </ol>
          </div>

          <!-- Booking Summary -->
          <div class="booking-summary" *ngIf="seatSelections.length > 0">
            <h4>Your Booking Details</h4>
            <div class="summary-item" *ngFor="let seat of seatSelections">
              <div class="seat-info">
                <span class="seat-name">Seat Type {{ seat.SeatTypeId }}</span>
                <span class="seat-quantity">× {{ seat.Quantity }}</span>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- RIGHT SECTION -->
      <aside class="payment-right">
        <!-- Event Summary Card -->
        <div class="summary-card" *ngIf="eventTitle">
          <div class="summary-header">
            <div class="summary-title">{{ eventTitle }}</div>
            <div class="summary-amount">₹{{ totalAmount }}</div>
          </div>

          <div class="summary-body">
            <p>{{ getTotalTickets() }} Tickets</p>
            <p *ngIf="eventDate">{{ formatDate(eventDate) }}</p>
            <p *ngIf="eventTime">{{ eventTime }}</p>
            <p class="muted">Venue</p>
            <p *ngIf="eventLocation">{{ eventLocation }}</p>

            <hr />

            <!-- Show seat details -->
            <div *ngFor="let seat of seatSelections" class="seat-detail">
              <p>Seat Type {{ seat.SeatTypeId }} · {{ seat.Quantity }} ticket(s)</p>
            </div>
          </div>
        </div>

        <!-- Price Breakdown -->
        <div class="price-breakup" *ngIf="totalAmount > 0">
          <div class="row">
            <span>Sub-total</span>
            <span>₹{{ totalAmount }}</span>
          </div>

          <div class="row">
            <span>Booking Fee (8.26%)</span>
            <span>₹{{ bookingFee }}</span>
          </div>

          <div class="row total">
            <span>Total Amount</span>
            <span>₹{{ finalAmount }}</span>
          </div>

          <div class="state-select">
            <label>Select State</label>
            <select [(ngModel)]="selectedState">
              <option>Maharashtra</option>
              <option>Delhi</option>
              <option>Karnataka</option>
              <option>Tamil Nadu</option>
              <option>Gujarat</option>
            </select>
          </div>

          <p class="consent">By proceeding, I express my consent to complete this transaction.</p>

          <!-- Payment Button -->
          <button 
            class="pay-btn" 
            (click)="onProceedToPay()" 
            [disabled]="isProcessing || seatSelections.length === 0">
            <span *ngIf="!isProcessing">Proceed to Pay ₹{{ finalAmount }}</span>
            <span *ngIf="isProcessing">Processing...</span>
          </button>

          <!-- Confirm Payment Button (shows after booking is created) -->
          <button 
            *ngIf="bookingDetails" 
            class="pay-btn confirm-btn"
            (click)="confirmPayment()" 
            [disabled]="isProcessing">
            <span *ngIf="!isProcessing">Confirm Payment</span>
            <span *ngIf="isProcessing">Confirming...</span>
          </button>

          <!-- Loading State -->
          <div *ngIf="isProcessing" class="loading-state">
            <div class="spinner"></div>
            <p>Please wait while we process your request...</p>
          </div>
        </div>
      </aside>
    </div>
  </main>
</div>