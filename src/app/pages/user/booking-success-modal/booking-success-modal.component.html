<div class="modal-overlay" (click)="onBackdropClick($event)">
    <div class="modal-content success-modal">
        <div class="modal-header">
            <div class="header-content">
                <div class="success-icon">‚úì</div>
                <div class="header-text">
                    <h3>üéâ Booking Confirmed!</h3>
                    <p class="subtitle">Booking #{{ bookingCode }}</p>
                </div>
            </div>
            <button class="modal-close" (click)="closeModal()">√ó</button>
        </div>

        <div class="modal-body">
            <!-- Thank You Message -->
            <div class="thank-you-message" *ngIf="thankYouMessage">
                <div class="message-icon">üíå</div>
                <p class="message-text">{{ thankYouMessage }}</p>
            </div>

            <!-- QR Code Display -->
            <div class="qr-code-section" *ngIf="qrCodeBase64">
                <h4>Your Entry QR Code</h4>
                <div class="qr-code-container">
                    <img [src]="'data:image/png;base64,' + qrCodeBase64" alt="Booking QR Code" class="qr-code-image"
                        (load)="onImageLoad()" (error)="onImageError()">
                    <div class="qr-loading" *ngIf="!imageLoaded && !imageError">
                        Loading QR code...
                    </div>
                    <div class="qr-error" *ngIf="imageError">
                        ‚ùå Failed to load QR code
                    </div>
                    <p class="qr-instruction">Present this QR code at the venue for entry</p>
                </div>

                <div class="qr-actions">
                    <button class="btn-download" (click)="downloadQRCode()" [disabled]="imageError || !imageLoaded">
                        <span class="btn-icon">‚¨á</span> Download QR Code
                    </button>
                    <button class="btn-share" (click)="shareQRCode()" [disabled]="imageError || !imageLoaded">
                        <span class="btn-icon">üì§</span> Share
                    </button>
                </div>
            </div>

            <!-- Booking Summary -->
            <div class="booking-summary" *ngIf="bookingDetails">
                <h4>Booking Details</h4>
                <div class="summary-grid">
                    <div class="summary-item">
                        <span class="label">Booking Code:</span>
                        <span class="value highlight">{{ bookingDetails.booking_code }}</span>
                    </div>
                    <div class="summary-item">
                        <span class="label">Event:</span>
                        <span class="value">{{ bookingDetails.event_name }}</span>
                    </div>
                    <div class="summary-item">
                        <span class="label">Date:</span>
                        <span class="value">{{ formatDate(bookingDetails.event_date) }}</span>
                    </div>
                    <div class="summary-item">
                        <span class="label">Time:</span>
                        <span class="value">{{ bookingDetails.start_time }} - {{ bookingDetails.end_time }}</span>
                    </div>
                    <div class="summary-item">
                        <span class="label">Venue:</span>
                        <span class="value">{{ bookingDetails.location }}</span>
                    </div>
                    <div class="summary-item">
                        <span class="label">Status:</span>
                        <span class="value status-confirmed">{{ bookingDetails.status | titlecase }}</span>
                    </div>
                </div>

                <!-- Total Amount -->
                <div class="total-amount">
                    <span class="total-label">Total Amount:</span>
                    <span class="total-value">‚Çπ{{ bookingDetails.total_amount }}</span>
                </div>

                <!-- Seat Details -->
                <div class="seat-details" *ngIf="bookingDetails.bookingSeats?.length">
                    <h5>Seat Details</h5>
                    <div class="seat-list">
                        <div class="seat-item" *ngFor="let seat of bookingDetails.bookingSeats; let i = index">
                            <span class="seat-number">{{ i + 1 }}.</span>
                            <span class="seat-type">{{ seat.seat_name }} √ó {{ seat.quantity }}</span>
                            <span class="seat-price">‚Çπ{{ seat.subtotal }}</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Email Notification -->
            <div class="email-notification" *ngIf="bookingDetails?.email">
                <div class="email-icon">üìß</div>
                <div class="email-text">
                    <p><strong>A confirmation email has been sent to:</strong></p>
                    <p class="email-address">{{ bookingDetails.email }}</p>
                    <p class="email-note">Check your inbox (and spam folder) for the QR code</p>
                </div>
            </div>

            <!-- Important Notes -->
            <div class="important-notes">
                <h5>Important Information</h5>
                <ul>
                    <li>Please arrive at least 30 minutes before the event</li>
                    <li>Present your QR code at the entry gate</li>
                    <li>Keep this QR code safe - it's your ticket!</li>
                    <li>No physical tickets required</li>
                </ul>
            </div>

            <!-- Action Buttons -->
            <div class="modal-actions">
                <button class="btn-secondary" (click)="viewBookingDetails()">
                    <span class="btn-icon">üìã</span> View Booking Details
                </button>
                <button class="btn-primary" (click)="goToEvents()">
                    <span class="btn-icon">‚Üê</span> Back to Events
                </button>
            </div>
        </div>

        <div class="modal-footer">
            <p>Need help? Contact support@tickethouse.in</p>
            <p class="footer-note">Thank you for choosing <strong>TicketHouse</strong>!</p>
        </div>
    </div>
</div>