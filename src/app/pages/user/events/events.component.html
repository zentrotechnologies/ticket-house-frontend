<div class="audience-page audience-body">
  <!-- Events Header with Column Structure -->
  <header class="audience-header">
    <div class="container">
      <div class="header-row">
        <!-- Logo + Search Combined Column - 70% -->
        <div class="header-col left-section-col">
          <div class="left-section-content">
            <!-- Logo -->
            <div class="logo-wrapper">
              <img class="logo"
                src="https://zentrotechnologies.com/wp-content/uploads/2025/02/Zentro_Final-Logo-05-scaled-e1753251642526.png"
                alt="Zentro Logo" />
            </div>

            <!-- Search -->
            <div class="search-wrapper">
              <div class="search">
                <input placeholder="Search for Events, Artists, Location..." aria-label="search" />
              </div>
            </div>
          </div>
        </div>

        <!-- Actions Column - 30% -->
        <div class="header-col actions-col">
          <div class="user-actions">
            <div class="location muted">Pune ‚ñº</div>

            <!-- Show user welcome with dropdown when logged in -->
            <div *ngIf="isUserLoggedIn" class="user-welcome-dropdown">
              <div class="user-welcome-trigger" (click)="toggleDropdown()">
                Welcome, {{ getUserDisplayName() }}! ‚ñº
              </div>

              <!-- Dropdown menu -->
              <div *ngIf="showUserDropdown" class="user-dropdown-menu">
                <div class="dropdown-item" (click)="onViewProfile()">
                  View Profile
                </div>
                <div class="dropdown-item" (click)="onViewBookings()">
                  My Bookings
                </div>
                <div class="dropdown-divider"></div>
                <div class="dropdown-item logout-item" (click)="onLogout()">
                  <span class="logout-icon">üö™</span>
                  Logout
                </div>
              </div>
            </div>

            <!-- Show Sign In button when not logged in -->
            <div *ngIf="!isUserLoggedIn" class="pill" (click)="onSignIn()">Sign In</div>
          </div>
        </div>
      </div>
    </div>
  </header>

  <!-- events-page.component.html -->
  <div class="events-page">
    <section class="hero">
      <div class="events-container">
        <span class="badge">Satrangi Re</span>
        <h1>PUNE ‚Äî <small>By Sonu Nigam</small></h1>
        <p class="hero-sub">Experience the musical night in the city with live performance</p>
        <div class="date-pill">10th January 2026</div>
      </div>
    </section>

    <main class="events-main">
      <div class="events-container">
        <!-- Coming This Week -->
        <section class="events-section">
          <h2 class="section-title">{{ sectionTitle }}</h2>

          <div *ngIf="isLoadingEvents" class="loading-spinner">Loading events...</div>

          <div *ngIf="!isLoadingEvents && upcomingEvents.length === 0" class="no-events">
            <p>No upcoming events found.</p>
          </div>

          <div *ngIf="!isLoadingEvents && upcomingEvents.length > 0" class="cards-grid">
            <!-- <div *ngFor="let event of upcomingEvents" class="event-card">
              <div
                class="poster"
                [style.background-image]="
                  'url(' +
                  (event.banner_image ||
                    'https://images.unsplash.com/photo-1526178611801-4f9d2f6d1a6c?w=800&q=60') +
                  ')'
                "
              ></div>
              <p class="meta">
                {{ event.formatted_date || formatDate(event.event_date) }}, {{ event.start_time }}
              </p>
              <p class="title">{{ event.event_name }}</p>
              <p class="meta">{{ event.location }}</p>
            </div> -->

            <div *ngFor="let event of upcomingEvents" class="event-card">
              <div class="card-content" (click)="onEventClick(event)">
                <div class="poster" [style.background-image]="
                    'url(' +
                    (event.banner_image ||
                      'https://images.unsplash.com/photo-1526178611801-4f9d2f6d1a6c?w=800&q=60') +
                    ')'
                  ">
                </div>
                <p class="meta">
                  {{ event.formatted_date || formatEventDate(event.event_date) }}, {{ event.start_time }}
                </p>
                <p class="title">{{ event.event_name }}</p>
                <p class="meta">{{ event.location }}</p>
              </div>
            </div>
          </div>

          <!-- Add View All Button - Only if you've implemented the method -->
          <!--
          <div *ngIf="upcomingEvents.length > 0" class="view-all-container">
            <button class="view-all-btn" (click)="viewAllEvents()">View All Upcoming Events</button>
          </div>
          -->
        </section>

        <!-- Show by Artist -->
        <section class="artist-strip">
          <h2 class="section-title">Show by Artist</h2>

          <div *ngIf="isLoadingArtists" class="loading-spinner">Loading artists...</div>

          <div *ngIf="!isLoadingArtists && artists.length === 0" class="no-artists">
            <p>No artists found.</p>
          </div>

          <div *ngIf="!isLoadingArtists && artists.length > 0" class="artist-list">
            <div *ngFor="let artist of artists" class="artist-card">
              <div class="artist-pic" [style.background-image]="
                  'url(' +
                  (artist.artist_photo ||
                    'https://images.unsplash.com/photo-1544005313-94ddf0286df2?w=600&q=60') +
                  ')'
                "></div>
              <p class="name">{{ artist.artist_name }}</p>
              <!-- <p class="role">{{ artist.role }}</p> -->
            </div>
          </div>
        </section>

        <!-- Testimonial -->
        <section class="testimonial-section">
          <h2 class="section-title">Testimonial by Artists</h2>

          <div *ngIf="isLoadingTestimonials" class="loading-spinner">Loading testimonials...</div>

          <div *ngIf="!isLoadingTestimonials && testimonials.length === 0" class="no-testimonials">
            <p>No testimonials found.</p>
          </div>

          <div *ngIf="!isLoadingTestimonials && testimonials.length > 0" class="testimonial">
            <!-- <div
              class="test-img"
              [style.background-image]="
                'url(' +
                (getCurrentTestimonial()?.profile_img ||
                  'https://images.unsplash.com/photo-1504814532845-3f33f25f2b2d?w=1200&q=60') +
                ')'
              "
            ></div> -->
            <div class="test-img" [style.background-image]="
                'url(' +
                (
                  'assets/default-avatar.png') +
                ')'
              "></div>
            <div class="test-text">
              <h3>{{ getCurrentTestimonial()?.name || 'Saurabh Bhosale' }}</h3>
              <p class="role">
                {{ getCurrentTestimonial()?.role || 'Stand-up Comedian & Storyteller' }}
              </p>
              <p class="desc">
                {{
                getCurrentTestimonial()?.description ||
                'Finally, a platform built for performers like us! Managing small shows and stand-up gigs has never been
                this easy. From listing events to tracking sales ‚Äî everything feels simple and reliable.'
                }}
              </p>
            </div>
            <div class="arrow" (click)="nextTestimonial()">‚ùØ</div>
          </div>
        </section>

        <!-- CTA -->
        <section class="cta-section">
          <div class="cta">
            <p class="cta-text">List Your Show ‚Äî It's Free!</p>
            <button class="cta-btn" (click)="navigateToSignUp()">Contact Us</button>
          </div>
        </section>
      </div>
    </main>

    <footer class="events-footer">
      <div class="events-container">
        <div class="footer-content">
          <img
            src="https://zentrotechnologies.com/wp-content/uploads/2025/02/Zentro_Final-Logo-05-scaled-e1753251642526.png"
            class="footer-logo" alt="Zentro Logo" />
          <div class="footer-links">
            <span>List Your Event</span>
            <span>|</span>
            <span>Help & Support</span>
            <span>|</span>
            <span>Terms & Conditions</span>
            <span>|</span>
            <span>Privacy Policy</span>
          </div>
          <p class="copy">¬© 2025 Ticket House ‚Äì All rights reserved.</p>
        </div>
      </div>
    </footer>
  </div>
  <!-- Add the Login/Signup Modal at the bottom -->
  <div *ngIf="showAuthModal" class="modal-overlay">
    <div class="modal-content auth-modal">
      <div class="modal-header">
        <h3>{{ isLoginMode ? 'Sign In' : 'Create Account' }}</h3>
        <button class="modal-close" (click)="onCloseAuthModal()">√ó</button>
      </div>

      <div class="modal-body">
        <!-- Progress Steps for Signup -->
        <div *ngIf="!isLoginMode" class="signup-steps">
          <div class="step" [class.active]="signupStep === 1">
            <span class="step-number">1</span>
            <span class="step-text">Account Details</span>
          </div>
          <div class="step" [class.active]="signupStep === 2">
            <span class="step-number">2</span>
            <span class="step-text">Verify Email</span>
          </div>
        </div>

        <!-- Login Form -->
        <div *ngIf="isLoginMode && !showOTPVerification" class="login-section">
          <div class="form-group">
            <input type="email" [(ngModel)]="loginEmail" placeholder="Email" [disabled]="isLoading">
          </div>
          <div class="form-group">
            <input type="password" [(ngModel)]="loginPassword" placeholder="Password" [disabled]="isLoading">
          </div>

          <button class="auth-btn" (click)="onLogin()" [disabled]="isLoading || !loginEmail || !loginPassword">
            <span *ngIf="!isLoading">Sign In</span>
            <span *ngIf="isLoading">Signing In...</span>
          </button>

          <div class="auth-footer">
            <p>Don't have an account?
              <a (click)="switchToSignup()">Sign Up</a>
            </p>
          </div>
        </div>

        <!-- Step 1: Signup Form -->
        <div *ngIf="!isLoginMode && signupStep === 1" class="signup-section">
          <div class="form-group">
            <input type="text" [(ngModel)]="signupFirstName" placeholder="First Name" [disabled]="isLoading">
          </div>
          <div class="form-group">
            <input type="text" [(ngModel)]="signupLastName" placeholder="Last Name" [disabled]="isLoading">
          </div>
          <div class="form-group">
            <input type="email" [(ngModel)]="signupEmail" placeholder="Email" [disabled]="isLoading">
          </div>
          <div class="form-group">
            <input type="password" [(ngModel)]="signupPassword" placeholder="Password (min. 8 characters)"
              [disabled]="isLoading">
          </div>
          <div class="form-row">
            <div class="form-group country-code">
              <select [(ngModel)]="signupCountryCode" [disabled]="isLoading">
                <option value="+91">+91 IN</option>
                <option value="+1">+1 US</option>
                <option value="+44">+44 UK</option>
                <option value="+61">+61 AU</option>
                <option value="+65">+65 SG</option>
              </select>
            </div>
            <div class="form-group phone-number">
              <input type="text" [(ngModel)]="signupPhone" placeholder="Phone Number (optional)" [disabled]="isLoading">
            </div>
          </div>

          <button class="auth-btn" (click)="onSignupStep1()"
            [disabled]="isLoading || !signupFirstName || !signupEmail || !signupPassword || !isValidSignupStep1()">
            <span *ngIf="!isLoading">Send OTP</span>
            <span *ngIf="isLoading">Sending OTP...</span>
          </button>

          <div class="auth-footer">
            <p>Already have an account?
              <a (click)="switchToLogin()">Sign In</a>
            </p>
          </div>
        </div>

        <!-- Step 2: OTP Verification -->
        <div *ngIf="signupStep === 2 || showOTPVerification" class="otp-verification-section">
          <div class="verification-header">
            <h4>Verify Your Email</h4>
            <p>Enter the 4-digit code sent to<br>
              <strong>{{ signupEmail || loginEmail }}</strong>
            </p>
          </div>

          <div class="otp-input-container">
            <div class="otp-inputs">
              <input *ngFor="let i of [0,1,2,3]; let idx = index" type="text" maxlength="1" [(ngModel)]="otpDigits[idx]"
                (input)="onOtpInput($event, idx)" (keydown)="onOtpKeyDown($event, idx)" [disabled]="isLoading"
                class="otp-digit">
            </div>
          </div>

          <div class="otp-timer" *ngIf="otpTimer > 0">
            OTP expires in: {{ formatOtpTimer() }}
          </div>

          <div class="otp-actions">
            <button class="resend-btn" (click)="resendOTP()" [disabled]="otpTimer > 0 || isLoading">
              Resend OTP
            </button>

            <button class="verify-btn" (click)="verifyOTP()" [disabled]="!isOtpComplete() || isLoading">
              <span *ngIf="!isLoading">Verify & Continue</span>
              <span *ngIf="isLoading">Verifying...</span>
            </button>
          </div>

          <div class="auth-footer" *ngIf="signupStep === 2">
            <a (click)="goBackToStep1()">‚Üê Back to Signup</a>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>